[ë ˆí”Œë¦¿ ì „ë‹¬ìš© ì§€ì‹œë¬¸] â€“ CoinMarketCap URL ì˜¤ë¥˜ ì™„ì „ í•´ê²° íŒ¨ì¹˜ ì ìš© ìš”ì²­

ë‹¤ìŒ ë‚´ìš©ì„ ê·¸ëŒ€ë¡œ ì ìš©í•´ ì£¼ì„¸ìš”.
í˜„ì¬ CMC URLì´ /search/?q= ë¡œë§Œ ì—´ë¦¬ëŠ” ì´ìœ ëŠ” API ì‘ë‹µì—ì„œ cmcSlug í•„ë“œê°€ ëˆ„ë½ë˜ì–´ í”„ë¡ íŠ¸ê°€ í•­ìƒ fallback ê²½ë¡œë¡œë§Œ ì²˜ë¦¬í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.
ë”°ë¼ì„œ table-filtered.ts íŒŒì¼ ìˆ˜ì •ì´ ë°˜ë“œì‹œ í•„ìš”í•©ë‹ˆë‹¤.

ğŸ”§ 1. ìˆ˜ì •í•  íŒŒì¼
src/pages/api/premium/table-filtered.ts

ğŸ”¥ 2. ë°˜ë“œì‹œ ì•„ë˜ ì½”ë“œë¡œ ì „ì²´ êµì²´í•´ì£¼ì„¸ìš” (ì•„ë˜ ì½”ë“œ ê·¸ëŒ€ë¡œ ë³µë¶™)
import type { NextApiRequest, NextApiResponse } from "next";
import premiumTable from "@/data/premiumTable.json";
import exchangeMarkets from "@/data/exchange_markets.json";
import masterSymbols from "@/data/master_symbols.json";

export default async function handler(req: NextApiRequest, res: NextApiResponse) {
  try {
    const results: any[] = [];

    for (const row of premiumTable) {
      const symbol = row.symbol;
      const baseSymbol = symbol.includes("/") ? symbol.split("/")[0] : symbol;

      // master_symbols ë§¤ì¹­
      const master = masterSymbols.find((m: any) => m.symbol === baseSymbol);

      // exchange_markets ë§¤ì¹­
      const market = exchangeMarkets.find((m: any) => m.baseSymbol === baseSymbol);

      // cmcSlug ìš°ì„ ìˆœìœ„ (ì–´ë””ì— ìˆì–´ë„ ë¬´ì¡°ê±´ ì¡íˆë„ë¡ ì„¤ì •)
      const cmcSlug =
        row.cmcSlug ||           // premiumTable.json (ìµœìƒìœ„ ìš°ì„ )
        market?.cmcSlug ||       // exchange_markets.json
        master?.cmc_slug ||      // master_symbols.cmc_slug
        null;                    // ì—†ìœ¼ë©´ null â†’ í”„ë¡ íŠ¸ëŠ” /search?q= ì²˜ë¦¬

      // ì—¬ê¸°ì„œ cmcSlugë¥¼ ë°˜ë“œì‹œ ì‘ë‹µì— í¬í•¨í•´ì•¼ í”„ë¡ íŠ¸ê°€ ì •ìƒ ì‘ë™í•©ë‹ˆë‹¤.
      results.push({
        symbol: row.symbol,
        koreanName: row.koreanName,
        domesticPrice: row.koreanPrice,
        globalPrice: row.globalPrice,
        premium: row.premium,
        domesticExchange: row.domesticExchange,
        foreignExchange: row.foreignExchange,
        volume24hKrw: row.volume24hKrw,
        volume24hUsdt: row.volume24hUsdt,
        change24h: row.change24h,
        cmcSlug: cmcSlug,     // â† í•µì‹¬! ë°˜ë“œì‹œ í¬í•¨í•´ì•¼ í•¨
      });
    }

    res.status(200).json({
      success: true,
      data: results,
      count: results.length,
    });
  } catch (err) {
    console.error("TABLE FILTER ERROR:", err);
    res.status(500).json({ success: false, error: "Internal server error" });
  }
}

ğŸ“Œ 3. ì´ ìˆ˜ì •ì´ í•„ìš”í•œ ì´ìœ  (ê°œë°œíŒ€ì´ ì´í•´í•˜ê¸° ì‰½ê²Œ)

í˜„ì¬ í”„ë¡ íŠ¸ì—ì„œëŠ” openCmcPage(symbol, cmcSlug) ë¡œ URLì„ ë§Œë“ ë‹¤.

ê·¸ëŸ¬ë‚˜ API ì‘ë‹µ(json)ì— cmcSlugê°€ ì•„ì˜ˆ í¬í•¨ë˜ì§€ ì•ŠìŒ â†’ í•­ìƒ null

null ê°’ì´ ë“¤ì–´ì˜¤ë©´ í”„ë¡ íŠ¸ëŠ” fallback URL:

https://coinmarketcap.com/ko/search/?q=btc


ë§Œ ì—´ê²Œ ë˜ì–´ ìˆìŒ.

ê·¸ë˜ì„œ BTC / ETHì²˜ëŸ¼ slugê°€ ìˆëŠ” ì½”ì¸ë“¤ë„ ê²€ìƒ‰ í˜ì´ì§€ë§Œ ì—´ë¦¬ëŠ” ë¬¸ì œ ë°œìƒ.

ìœ„ íŒ¨ì¹˜ë¥¼ ì ìš©í•˜ë©´:

/currencies/bitcoin/
/currencies/ethereum/
/currencies/chainlink/


ëª¨ë‘ ì •ìƒ ì´ë™í•œë‹¤.

ğŸš€ 4. íŒ¨ì¹˜ í›„ í™•ì¸ ë°©ë²•

ì„œë²„ ì¬ì‹œì‘ í›„ ë¸Œë¼ìš°ì €ì—ì„œ BTC/ETH ì½”ì¸ëª… í´ë¦­

ì´ë™ URLì´ ì•„ë˜ì²˜ëŸ¼ ë‚˜ì˜¤ëŠ”ì§€ í™•ì¸:

https://coinmarketcap.com/ko/currencies/bitcoin/


ì½˜ì†” ë¡œê·¸:

[CMC_URL] Using slug: bitcoin

ğŸ”¥ 5. ë°˜ë“œì‹œ ì´ ìˆœì„œëŒ€ë¡œ ì§„í–‰

table-filtered.ts ìœ„ ì½”ë“œë¡œ ì™„ì „ êµì²´

ì €ì¥ í›„ ì„œë²„ ìë™ ì¬ë¹Œë“œ í™•ì¸

í”„ë¡ íŠ¸ F5 ìƒˆë¡œê³ ì¹¨ í›„ í…ŒìŠ¤íŠ¸