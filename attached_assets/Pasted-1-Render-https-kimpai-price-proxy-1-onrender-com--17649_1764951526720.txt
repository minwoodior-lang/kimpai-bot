1. ì§€ê¸ˆ ìƒíƒœ ì •ë¦¬ (ë ˆí”Œë¦¿ì—ê²Œ ì„¤ëª…í•  ë‚´ìš©)

Render í”„ë¡ì‹œ ë„ë©”ì¸
https://kimpai-price-proxy-1.onrender.com

ì•„ë˜ ì„¸ ì—”ë“œí¬ì¸íŠ¸ ì •ìƒ ì‘ë‹µ í™•ì¸ ì™„ë£Œ:

/healthz

/binance/api/v3/ticker/24hr?symbol=BTCUSDT

/binance/fapi/v1/ticker/24hr?symbol=BTCUSDT

OKX / Bybit / MEXC / Gate WebSocketì€ ë ˆí”Œë¦¿ì—ì„œ ì´ë¯¸ ë¶™ì–´ ìˆìŒ.

ê·¸ëŸ°ë° í™”ë©´ì—ì„œ

BINANCE_USDT spot

BINANCE_FUTURES ì„ ë¬¼

BYBIT / GATE / MEXC
ì´ ë„¤íŠ¸ì›Œí¬ ê¸°ì¤€ìœ¼ë¡œ ì„ íƒí•˜ë©´ í˜„ì¬ê°€/ê±°ë˜ì•¡ ê°’ì´ ë¹„ê±°ë‚˜ 0ìœ¼ë¡œ ë‚˜ì˜¤ëŠ” ë¬¸ì œê°€ ë‚¨ì•„ ìˆìŒ.

2. ë ˆí”Œë¦¿ì—ê²Œ ê·¸ëŒ€ë¡œ ë˜ì§ˆ ì „ë‹¬ë¬¸

ì´ê±° í†µì§¸ë¡œ ë³µë¶™í•´ì„œ ë ˆí”Œë¦¿ ì±„íŒ…ì— ë„£ìœ¼ë©´ ë¼ ğŸ‘‡

[TASK 1] Binance Spot / Futures ë¥¼ Render í”„ë¡ì‹œë¡œ ê°•ì œ ì—°ê²°

í™˜ê²½ë³€ìˆ˜ ë˜ëŠ” ìƒìˆ˜ë¡œ í”„ë¡ì‹œ ë² ì´ìŠ¤ URLì„ í•˜ë‚˜ ì¡ì•„ì¤˜:

// ì˜ˆ: workers/fetchers/binance.ts
const PRICE_PROXY_BASE_URL =
  process.env.PRICE_PROXY_BASE_URL ||
  "https://kimpai-price-proxy-1.onrender.com";


Binance Spot/Futures 24hr í†µê³„ fetch í•¨ìˆ˜ì—ì„œ
ì§ì ‘ Binance ë„ë©”ì¸ì„ í˜¸ì¶œí•˜ì§€ ë§ê³  í”„ë¡ì‹œë¥¼ ì‚¬ìš©í•˜ê²Œ ë°”ê¿”ì¤˜.

Spot 24hr:

// BEFORE (ì§ì ‘ í˜¸ì¶œ)
// https://api.binance.com/api/v3/ticker/24hr

// AFTER (í”„ë¡ì‹œ ê²½ìœ )
const url = `${PRICE_PROXY_BASE_URL}/binance/api/v3/ticker/24hr`;


Futures 24hr:

// BEFORE
// https://fapi.binance.com/fapi/v1/ticker/24hr

// AFTER
const url = `${PRICE_PROXY_BASE_URL}/binance/fapi/v1/ticker/24hr`;


ìœ„ ë‘ í•¨ìˆ˜ì—ì„œ ë°›ì•„ì˜¨ ë°ì´í„°ë¡œ marketStats[ "BINANCE:SYMBOL:USDT" ] ì™€
marketStats[ "BINANCE_FUTURES:SYMBOL:USDT" ] ì˜
volume24hQuote í•„ë“œë¥¼ ë°˜ë“œì‹œ ì±„ì›Œì¤˜.

priceWorker / statsWorkerì—ì„œ Binance ìª½ì€ WebSocketì´ ë§‰í˜€ ìˆìœ¼ë©´ í”„ë¡ì‹œ RESTë¡œ í´ë°±í•˜ëŠ” êµ¬ì¡°ë§Œ ìœ ì§€í•˜ë©´ ëœë‹¤.
WebSocket ì•ˆ ë¶™ì–´ ìˆì–´ë„ ì¢‹ìœ¼ë‹ˆ, ìµœì†Œí•œ REST + í”„ë¡ì‹œ ì¡°í•©ìœ¼ë¡œ í˜„ì¬ê°€/ê±°ë˜ì•¡ì´ ì œëŒ€ë¡œ ë‚˜ì˜¤ê²Œ í•˜ëŠ” ê²Œ 1ì°¨ ëª©í‘œ.

[TASK 2] Bybit / Gate / MEXC í˜„ì¬ê°€ & ê±°ë˜ì•¡ ì—°ê²° ìƒíƒœ ì ê²€

ì´ë¯¸ WebSocket í•˜ì´ë¸Œë¦¬ë“œê°€ ìˆë‹¤ë©´ ê·¸ëŒ€ë¡œ ë‘ê³ , ìµœì¢…ì ìœ¼ë¡œ marketStats.jsonì— ì œëŒ€ë¡œ ë“¤ì–´ê°€ëŠ”ì§€ í™•ì¸í•´ì¤˜.

data/marketStats.json ìƒì„± ë¡œì§ì—ì„œ ë‹¤ìŒ í‚¤ë“¤ì„ ê²€ì‚¬í•´ì¤˜:

// ì˜ˆì‹œ í‚¤
"BYBIT:BTC:USDT"
"GATE:BTC:USDT"
"MEXC:BTC:USDT"


ê°ê°ì— ëŒ€í•´:

lastPrice ë˜ëŠ” close ê°™ì€ í˜„ì¬ê°€ í•„ë“œ

quote_volume / quoteVolume ì—ì„œ íŒŒìƒí•œ volume24hQuote
ê°€ 0ì´ ì•„ë‹Œ ê°’ìœ¼ë¡œ ë“¤ì–´ê°€ ìˆì–´ì•¼ í•œë‹¤.

í•„ìš”í•˜ë©´ fetcher ë§¤í•‘ì„ ë‹¤ì‹œ í™•ì¸í•´ì¤˜:

Gate 24hr: quote_volume ì‚¬ìš©

MEXC 24hr: quoteVolume ì‚¬ìš©

Bybit: result.list[*].turnover24h ë‚˜ volume24h â†’ USDT ê¸°ì¤€ìœ¼ë¡œ ë³€í™˜í•´ì„œ volume24hQuote ì— ë„£ê¸°

statsWorker ë¡œê·¸ì— ë‹¤ìŒì²˜ëŸ¼ ë””ë²„ê¹… ë¡œê·¸ë¥¼ ì ê¹ ì¶”ê°€í•´ì¤˜:

console.log("[STATS_DEBUG]",
  "BINANCE_FUTURES BTC:", marketStats["BINANCE_FUTURES:BTC:USDT"]?.volume24hQuote,
  "BYBIT BTC:", marketStats["BYBIT:BTC:USDT"]?.volume24hQuote,
  "GATE BTC:", marketStats["GATE:BTC:USDT"]?.volume24hQuote,
  "MEXC BTC:", marketStats["MEXC:BTC:USDT"]?.volume24hQuote,
);


ì´ ê°’ë“¤ì´ ìˆ«ìë¡œ ì˜ ì°íˆëŠ”ì§€ í™•ì¸í•´ì¤˜.

[TASK 3] PremiumTable íŒŒì´í”„ë¼ì¸ ì—°ê²° í™•ì¸

ì ˆëŒ€ ìˆ˜ì •í•˜ë©´ ì•ˆ ë˜ëŠ” íŒŒì¼/ë¡œì§ (ì´ë¯¸ ë‚´ ìš”ì²­ëŒ€ë¡œ ì™„ì„±ëœ ì˜ì—­):

src/pages/api/premium/table-filtered.ts

KRW/USDT/BTC ê¸°ì¤€ì— ë”°ë¼ volume24hKrw, volume24hForeignKrw ê³„ì‚°í•˜ëŠ” ë¶€ë¶„

ì£¼ì„ìœ¼ë¡œ â€œì„ì˜ ìˆ˜ì • ê¸ˆì§€ (PM í˜‘ì˜ í•„ìˆ˜)â€ ì í˜€ ìˆëŠ” ë¡œì§

src/components/PremiumTable.tsx

ê±°ë˜ì•¡ ì…€ì—ì„œ row.volume24hKrw / row.volume24hForeignKrw ë¥¼ í‘œì‹œí•˜ëŠ” ë¶€ë¶„

table-filtered APIê°€ ì•„ë˜ ì¡°í•©ì—ì„œ foreign ê±°ë˜ì•¡ì„ ì œëŒ€ë¡œ ëŒë ¤ì£¼ëŠ”ì§€ í™•ì¸í•´ì¤˜:

/api/premium/table-filtered?domestic=UPBIT_KRW&foreign=BINANCE_USDT
/api/premium/table-filtered?domestic=UPBIT_KRW&foreign=BINANCE_FUTURES_USDT
/api/premium/table-filtered?domestic=UPBIT_KRW&foreign=BYBIT_USDT
/api/premium/table-filtered?domestic=UPBIT_KRW&foreign=GATE_USDT
/api/premium/table-filtered?domestic=UPBIT_KRW&foreign=MEXC_USDT


ê° ì‘ë‹µì—ì„œ BTC, ETH, SUI ê°™ì€ ë©”ì´ì € ì½”ì¸ì˜

volume24hKrw (êµ­ë‚´)

volume24hForeignKrw (í•´ì™¸)
ê°’ì´ null ì´ë‚˜ 0ì´ ì•„ë‹ˆë¼ë©´ í”„ë¡ íŠ¸ì—ëŠ” ìë™ìœ¼ë¡œ ëœ¨ê²Œ ë˜ì–´ ìˆë‹¤.

ë§Œì•½ APIê¹Œì§€ëŠ” ê°’ì´ ë‚˜ì˜¤ëŠ”ë° í™”ë©´ì—ë§Œ ì•ˆ ë‚˜ì˜¨ë‹¤ë©´,

PremiumTable.tsx ì•ˆì— íŠ¹ì • foreign ê±°ë˜ì†Œë¥¼ í•„í„°ë§í•˜ëŠ” ì¡°ê±´ì´ ìˆëŠ”ì§€ ì²´í¬í•´ì¤˜

BINANCE / OKX ë§Œ í—ˆìš©í•˜ëŠ” ì‹ì˜ ì¡°ê±´ì´ ìˆìœ¼ë©´
ê±°ê¸°ì— BINANCE_FUTURES, BYBIT, GATE, MEXC ë¥¼ í•¨ê»˜ í—ˆìš©í•˜ë„ë¡ë§Œ ìˆ˜ì •í•´ì¤˜.