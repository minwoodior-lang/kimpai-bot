📌 레플릿 개발팀 전달문
1) 코인셀 차트 아이콘 위치 변경

현재:

테이블 맨 오른쪽에 “차트” 컬럼이 추가되어 있고,

그 컬럼 안에 📈 아이콘 버튼이 있습니다.

요청:

맨 오른쪽 “차트” 컬럼은 완전히 삭제해주세요.

📈 차트 아이콘은 코인명 왼쪽, 즐겨찾기 별 옆 정도 위치로 옮겨주세요.
(예: ★ – 📈 – 코인 아이콘 – 코인명 – 심볼 순서)

예시 구조:

// 기존: 별 / 코인아이콘 / 이름 / 심볼
<td className="px-3 py-2">
  <div className="flex items-center gap-2">
    {/* 즐겨찾기 버튼 */}
    <button ...>★</button>

    {/* 차트 버튼 - 여기로 이동 */}
    <button
      type="button"
      onClick={() => handleOpenChart(row)}
      className="p-1"
    >
      <ChartIcon className="w-3 h-3 md:w-4 md:h-4" />
    </button>

    {/* 코인 아이콘 */}
    <CoinIcon symbol={row.symbol} ... />

    {/* 이름/심볼 */}
    <div
      className="flex flex-col flex-1 min-w-0 cursor-pointer"
      onClick={() =>
        openCmcPage({
          symbol: row.symbol,
          cmcSlug: row.cmcSlug,
        })
      }
    >
      <span className="text-[11px] md:text-sm truncate">
        {row.nameKo}
      </span>
      <span className="text-[9px] md:text-xs text-white/50">
        {row.symbol}
      </span>
    </div>
  </div>
</td>


그리고 맨 오른쪽 “차트” 컬럼(th/td) 전체는 삭제해주세요.

2) 차트 버튼 눌렀을 때 엉뚱한 차트 열리는 문제

현재:

📈 버튼을 누르면 전혀 관계없는 차트가 뜨고 있습니다.

심볼 매핑이 잘못되었거나, Apple 등 예제 심볼을 그대로 사용한 것으로 보입니다.

요청:

아래 규칙대로 tvSymbol을 다시 매핑해주세요.

2-1. 규칙 정리

기준 거래소가 업비트 / 빗썸일 때
→ 그 기준 거래소의 마켓 기준으로 차트 열기

예: 기준거래소 = 업비트, 마켓 = KRW, 심볼 = BTC
→ UPBIT:BTCKRW

예: 기준거래소 = 빗썸, 마켓 = BTC, 심볼 = ETH
→ BITHUMB:ETHBTC

기준 거래소가 코인원일 때
→ 코인원은 TradingView 심볼이 없으므로
→ 선택된 해외 거래소 + 해외 마켓(USDT/BTC) 기준으로 차트 열기

예: 기준거래소 = 코인원, 해외 거래소 = Binance, 해외 마켓 = USDT, 심볼 = BTC
→ BINANCE:BTCUSDT

예외 / 심볼이 없을 때
→ 기본 fallback: BINANCE:{symbol}USDT

2-2. 코드 예시
type DomesticExchange = "UPBIT" | "BITHUMB" | "COINONE";
type DomesticMarket = "KRW" | "BTC" | "USDT";
type ForeignExchange =
  | "BINANCE"
  | "OKX"
  | "BYBIT"
  | "BITGET"
  | "GATEIO"
  | "MEXC"
  | "HTX";
type ForeignMarket = "USDT" | "BTC";

const TV_DOMESTIC_PREFIX: Record<Exclude<DomesticExchange, "COINONE">, string> = {
  UPBIT: "UPBIT",
  BITHUMB: "BITHUMB",
};

const TV_FOREIGN_PREFIX: Record<ForeignExchange, string> = {
  BINANCE: "BINANCE",
  OKX: "OKX",
  BYBIT: "BYBIT",
  BITGET: "BITGET",
  GATEIO: "GATEIO",
  MEXC: "MEXC",
  HTX: "HTX",
};

function getTvSymbolForRow(params: {
  symbol: string;
  domesticExchange: DomesticExchange;
  domesticMarket: DomesticMarket;
  foreignExchange: ForeignExchange;
  foreignMarket: ForeignMarket;
}): string {
  const { symbol, domesticExchange, domesticMarket, foreignExchange, foreignMarket } = params;

  // 1) 업비트 / 빗썸
  if (domesticExchange === "UPBIT" || domesticExchange === "BITHUMB") {
    const prefix = TV_DOMESTIC_PREFIX[domesticExchange];
    return `${prefix}:${symbol}${domesticMarket}`;
  }

  // 2) 코인원 → 해외 거래소 기준
  if (domesticExchange === "COINONE") {
    const prefix = TV_FOREIGN_PREFIX[foreignExchange] ?? "BINANCE";
    return `${prefix}:${symbol}${foreignMarket}`;
  }

  // 3) fallback
  return `BINANCE:${symbol}USDT`;
}


📌 핸들러 연결

function handleOpenChart(row: RowType) {
  const tvSymbol = getTvSymbolForRow({
    symbol: row.symbol,
    domesticExchange,
    domesticMarket,
    foreignExchange,
    foreignMarket,
  });

  openTradingViewChart(tvSymbol); // 아래 2-3 참고
}

2-3. 프리미엄 차트에 심볼 반영

openTradingViewChart(tvSymbol) 함수는
홈 상단 프리미엄 차트의 상태를 바꿔주세요.

// 홈 컴포넌트
const [premiumTvSymbol, setPremiumTvSymbol] = useState("BINANCE:BTCUSDT");

// 차트 클릭 시
function openTradingViewChart(tvSymbol: string) {
  setPremiumTvSymbol(tvSymbol);
}

// 프리미엄 차트 렌더
<TradingViewChartDynamic tvSymbol={premiumTvSymbol} height={360} />

3) 프리미엄 차트 & CoinMarketCap 링크 최종 정리
3-1. 프리미엄 차트

프리미엄 차트 영역에는 TradingView 차트 1개만 있어야 합니다.

초기값은 BINANCE:BTCUSDT 고정:

<TradingViewChartDynamic tvSymbol={premiumTvSymbol} height={360} />


Apple 데모 차트, 예제 위젯, 중복 카드 등은 모두 제거해주세요.

3-2. CoinMarketCap 링크

코인명(또는 심볼) 클릭 시 URL 형식:

https://coinmarketcap.com/ko/currencies/{cmcSlug}/?utm_source=apiswap&utm_medium=web&utm_campaign=kimpga


slug가 없을 때만 검색 페이지로 fallback:

export function openCmcPage({ symbol, cmcSlug }: { symbol: string; cmcSlug?: string }) {
  let url: string;

  if (cmcSlug && cmcSlug.trim().length > 0) {
    url =
      `https://coinmarketcap.com/ko/currencies/${cmcSlug}/` +
      `?utm_source=apiswap&utm_medium=web&utm_campaign=kimpga`;
  } else {
    const query = encodeURIComponent(symbol.toLowerCase());
    url = `https://coinmarketcap.com/ko/search/?q=${query}`;
  }

  if (typeof window !== "undefined") {
    window.open(url, "_blank", "noopener,noreferrer");
  }
}


코인셀에서는 반드시 cmcSlug를 넘겨서 호출해야 합니다.

onClick={() =>
  openCmcPage({
    symbol: row.symbol,
    cmcSlug: row.cmcSlug, // ✅ symbol이 아니라 slug
  })
}

✅ 최종 요약

코인셀 우측 끝 “차트” 컬럼 삭제, 📈 아이콘을 코인명 왼쪽으로 이동

getTvSymbolForRow 로직을 위 규칙대로 수정해서

업비트/빗썸 → 국내 차트

코인원 → 선택 해외 거래소 차트
가 정확히 열리도록 하기

프리미엄 차트는

초기값 BINANCE:BTCUSDT

클릭 시 premiumTvSymbol 변경해서 같은 박스 안에서 차트만 교체

CMC 링크는 slug 기반 상세 URL로 수정 (/ko/currencies/{cmcSlug}/?...)