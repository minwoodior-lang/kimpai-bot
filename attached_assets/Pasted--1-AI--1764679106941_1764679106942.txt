[ìš”ì²­ 1] ê¸°ì¡´ ì½”ì¸/ì‹¬ë³¼/ì•„ì´ì½˜ ë°ì´í„° ì „ë¶€ ì´ˆê¸°í™”

ê¹€í”„ AI ìª½ì—ì„œ ì‚¬ìš©í•˜ëŠ” â€œì½”ì¸/ì‹¬ë³¼/ì•„ì´ì½˜/ë§ˆì¼“â€ ê´€ë ¨ í…Œì´ë¸”ì€
ì•ìœ¼ë¡œ ìƒˆ êµ¬ì¡°ë§Œ ì“¸ ì˜ˆì •ì´ë¼,
ì§€ê¸ˆê¹Œì§€ ì“°ë˜ ë°ì´í„°ëŠ” ì „ë¶€ ì‚­ì œí•´ë„ ë©ë‹ˆë‹¤.

ë§Œì•½ ì•„ë˜ì™€ ê°™ì€ í…Œì´ë¸”ì´ ìˆë‹¤ë©´ ì „ë¶€ ë°ì´í„° ì‚­ì œ(í•„ë“œ/í…Œì´ë¸”ì€ ì§€ì›Œë„ ë¨):

master_symbols

exchange_symbols

ê¸°íƒ€ ì½”ì¸ ì‹¬ë³¼/ì•„ì´ì½˜ìš© ì„ì‹œ í…Œì´ë¸”ë“¤

ì•ìœ¼ë¡œëŠ” ì•„ë˜ í…Œì´ë¸” í•˜ë‚˜ë¥¼ â€œì •ì‹ ì›ë³¸â€ìœ¼ë¡œ ì“°ê³  ì‹¶ìŠµë‹ˆë‹¤.

-- ê±°ë˜ì†Œ ë§ˆì¼“ í™”ë©´ ê·¸ëŒ€ë¡œ ì €ì¥í•˜ëŠ” ë©”ì¸ í…Œì´ë¸”
create table if not exists exchange_markets (
  id            bigserial primary key,
  exchange      text not null,    -- 'upbit' | 'bithumb' | 'coinone' ë“±
  market_code   text not null,    -- KRW-BTC, BTC_KRW, BTC/USDT ...
  base_symbol   text not null,    -- BTC
  quote_symbol  text not null,    -- KRW, USDT ...
  name_ko       text,             -- ë¹„íŠ¸ì½”ì¸ (ë§ˆì¼“ í™”ë©´ì— ë³´ì´ëŠ” í•œê¸€)
  name_en       text,             -- Bitcoin (ìˆìœ¼ë©´)
  icon_url      text,             -- ë§ˆì¼“ í™”ë©´ì—ì„œ ì“°ëŠ” ì½”ì¸ ì•„ì´ì½˜ URL
  is_active     boolean default true,
  created_at    timestamptz default now(),
  updated_at    timestamptz default now()
);

create unique index if not exists exchange_markets_unique_market
on exchange_markets (exchange, market_code);


ê¸°ì¡´ì— ë“¤ì–´ê°€ ìˆëŠ” ë°ì´í„°ëŠ” ì „ë¶€ ë²„ë ¤ë„ ë˜ë‹ˆ,

truncate table exchange_markets restart identity cascade;


í•œ ë²ˆ ì‹¤í–‰í•´ì„œ ì™„ì „ ì´ˆê¸°í™” ë¶€íƒë“œë¦½ë‹ˆë‹¤.
(í…Œì´ë¸”ì´ ì—†ë‹¤ë©´ create ë¨¼ì €, ì´í›„ë¶€í„°ëŠ” ì£¼ê¸°ì ìœ¼ë¡œ truncate ì•ˆ í•˜ê³  upsertë¡œë§Œ ê´€ë¦¬)

ğŸ¤– 2. ê±°ë˜ì†Œë³„ ë§ˆì¼“ í¬ë¡¤ëŸ¬/ì›Œì»¤ ì„¤ê³„

ì»¨ì…‰ì€ ë‹¨ìˆœí•©ë‹ˆë‹¤.

â€œì‚¬ëŒì´ ì›¹ì—ì„œ ë³´ëŠ” ê±°ë˜ì†Œ ë§ˆì¼“ ë¦¬ìŠ¤íŠ¸ í™”ë©´ = ë°ì´í„° ì›ë³¸â€
â†’ ê·¸ í™”ë©´ì—ì„œ ì•„ì´ì½˜ + í•œê¸€ëª… + ì˜ë¬¸ëª… + ì‹¬ë³¼ + ë§ˆì¼“ì½”ë“œë¥¼ ê¸ì–´ì„œ DBì— ë„£ê¸°

[ìš”ì²­ 2] refreshExchangeMarkets ì›Œì»¤ êµ¬í˜„

scripts/refreshExchangeMarkets.ts ì™€ ê°™ì´,

ì‹¤í–‰ ì‹œ ë‹¤ìŒ ì‘ì—…ì„ í•©ë‹ˆë‹¤:

type RawMarket = {
  exchange: "upbit" | "bithumb" | "coinone";
  marketCode: string;   // KRW-BTC, BTC_KRW, BTC/USDT
  baseSymbol: string;   // BTC
  quoteSymbol: string;  // KRW, USDT
  nameKo?: string;      // ë¹„íŠ¸ì½”ì¸
  nameEn?: string;      // Bitcoin
  iconUrl?: string;     // ë§ˆì¼“ ë¦¬ìŠ¤íŠ¸ì—ì„œ ì“°ëŠ” <img src="...">
};

async function refreshExchangeMarkets() {
  const upbit = await scrapeUpbitMarkets();
  const bithumb = await scrapeBithumbMarkets();
  const coinone = await scrapeCoinoneMarkets();

  const all: RawMarket[] = [...upbit, ...bithumb, ...coinone];

  // Supabase upsert
  // exchange + market_code ê¸°ì¤€ìœ¼ë¡œ upsert
  for (const m of all) {
    await supabase
      .from("exchange_markets")
      .upsert(
        {
          exchange: m.exchange,
          market_code: m.marketCode,
          base_symbol: m.baseSymbol,
          quote_symbol: m.quoteSymbol,
          name_ko: m.nameKo,
          name_en: m.nameEn,
          icon_url: m.iconUrl,
          is_active: true,
          updated_at: new Date().toISOString(),
        },
        { onConflict: "exchange,market_code" }
      );
  }

  // ê¸°ì¡´ì— DBì—ëŠ” ìˆëŠ”ë° ìµœê·¼ í¬ë¡¤ë§ ê²°ê³¼ì—ëŠ” ì—†ëŠ” ë§ˆì¼“ì€ is_active=false ì²˜ë¦¬(ì„ íƒ)
}

â–¸ scrapeUpbitMarkets()

ì—…ë¹„íŠ¸ KRW/BTC/USDT ë§ˆì¼“ ë¦¬ìŠ¤íŠ¸ í˜ì´ì§€(ì›¹) ê¸°ì¤€ìœ¼ë¡œ

ê° rowì—ì„œ:

ë§ˆì¼“ì½”ë“œ

ì‹¬ë³¼

í•œê¸€ëª… / ì˜ë¬¸ëª…

ì•„ì´ì½˜ <img src="...">

ìœ„ 4ê°€ì§€ ì •ë³´ë¥¼ íŒŒì‹±í•´ì„œ RawMarket[] ë°˜í™˜

â€» êµ¬í˜„ ë°©ë²•ì€ ììœ ì…ë‹ˆë‹¤.

ê°€ëŠ¥í•˜ë©´ ì •ì  ë¦¬ì†ŒìŠ¤(JS/JSON) íŒŒì‹±

í•„ìš”í•˜ë©´ puppeteer/Playwrightë¡œ DOM í¬ë¡¤ë§

â–¸ scrapeBithumbMarkets(), scrapeCoinoneMarkets()

ë¹—ì¸/ì½”ì¸ì›ë„ ë§ˆì°¬ê°€ì§€ë¡œ:

ë§ˆì¼“ ë¦¬ìŠ¤íŠ¸(ì „ì²´ ì½”ì¸ ë¦¬ìŠ¤íŠ¸ê°€ ë³´ì´ëŠ” í˜ì´ì§€)ë¥¼ ê¸°ì¤€

í•œê¸€ ì´ë¦„, ì‹¬ë³¼, ì•„ì´ì½˜ì„ ê·¸ëŒ€ë¡œ íŒŒì‹±

ì½”ì¸ì›ì—ì„œ ì´ë¦„ í¬ë§·ì´ íŠ¹ì´í•œ ê²½ìš°(ì˜ˆ: AMP/ì•”í”„, APT.APT ë“±)ëŠ”:

base_symbol: ì˜ë¬¸ ì‹¬ë³¼

name_ko: í•œê¸€ëª… (ìˆìœ¼ë©´)

name_en: ì²« ë²ˆì§¸ ì˜ë¬¸ ì´ë¦„

ì“¸ë°ì—†ëŠ” /, ., ê´„í˜¸ ë“±ì€ ì •ê·œì‹ìœ¼ë¡œ ì œê±°

â° 3. ìë™í™”(ìŠ¤ì¼€ì¤„ëŸ¬)

[ìš”ì²­ 3] ë§ˆì¼“ ë™ê¸°í™” ìŠ¤ì¼€ì¤„ëŸ¬ ë“±ë¡

npm run refresh:markets ê°™ì€ ìŠ¤í¬ë¦½íŠ¸ë¡œ
ìœ„ refreshExchangeMarkets ì‹¤í–‰ë˜ë„ë¡ ì„¤ì •í•´ ì£¼ì„¸ìš”.

ê·¸ë¦¬ê³  ì´ ìŠ¤í¬ë¦½íŠ¸ë¥¼

ìµœì†Œ 1ì‹œê°„ì— í•œ ë²ˆ,

ê°€ëŠ¥í•˜ë©´ 10~15ë¶„ ê°„ê²©ìœ¼ë¡œ í¬ë¡  ë“±ë¡í•´ì„œ

ê±°ë˜ì†Œ ë§ˆì¼“ ë¦¬ìŠ¤íŠ¸ê°€ ë°”ë€Œë©´ ìš°ë¦¬ DBë„ ìë™ ë°˜ì˜ë˜ë„ë¡ ì„¤ì •

ì´ë ‡ê²Œ ë˜ë©´:

ê±°ë˜ì†Œì— ìƒˆ ì½”ì¸ ìƒì¥ â†’ ë§ˆì¼“ ë¦¬ìŠ¤íŠ¸ì— ë…¸ì¶œ

ë‹¤ìŒ í¬ë¡  ì‹¤í–‰ ì‹œ â†’ exchange_marketsì— ìë™ insert/upsert

Kimp AI í”„ë¡ íŠ¸ë„ ê³§ë°”ë¡œ ìƒˆ ì½”ì¸ ë°˜ì˜

ğŸ¨ 4. í”„ë¡ íŠ¸ì—”ë“œ ìˆ˜ì • ë°©í–¥

[ìš”ì²­ 4] ì½”ì¸/ë§ˆì¼“ ë¦¬ìŠ¤íŠ¸ëŠ” ì „ë¶€ exchange_markets ê¸°ì¤€ìœ¼ë¡œ ë Œë”ë§

í˜„ì¬ í”„ë¡ íŠ¸ì—ì„œ ì½”ì¸ ëª©ë¡ / í”„ë¦¬ë¯¸ì—„ í…Œì´ë¸” ë“±ì—
ì‹¬ë³¼/ì´ë¦„/ì•„ì´ì½˜ì„ ê°€ì ¸ì˜¤ëŠ” ë¡œì§ì´ ì—¬ëŸ¬ êµ°ë° ì„ì—¬ ìˆì„ í…ë°,

ì•ìœ¼ë¡œëŠ” ë¬´ì¡°ê±´ exchange_markets í…Œì´ë¸”ì„ ê¸°ì¤€ìœ¼ë¡œë§Œ ì‚¬ìš©í•˜ê²Œ ì •ë¦¬í•˜ê³  ì‹¶ìŠµë‹ˆë‹¤.

ì˜ˆì‹œ:

// ì˜ˆ: ì—…ë¹„íŠ¸ KRW ë§ˆì¼“ë§Œ
const { data } = await supabase
  .from("exchange_markets")
  .select("*")
  .eq("exchange", "upbit")
  .eq("quote_symbol", "KRW")
  .eq("is_active", true);


ë Œë”ë§ ì‹œ:

const name =
  row.name_ko ||
  row.name_en ||
  row.base_symbol;

<CoinRow
  iconUrl={row.icon_url}
  name={name}
  symbol={row.base_symbol}
  marketCode={row.market_code}
/>


ê¸°ì¡´ì— ìˆ˜ë™ìœ¼ë¡œ ë„£ì–´ë‘” ì‹¬ë³¼/ì•„ì´ì½˜/í•œê¸€ëª…ì€ ì „ë¶€ ë¬´ì‹œí•´ë„ ë¨

â€œê±°ë˜ì†Œ ë§ˆì¼“ í™”ë©´ì— ì–´ë–»ê²Œ ë³´ì´ëƒâ€ê°€ í•­ìƒ ì •ë‹µì´ë¯€ë¡œ,
í”„ë¡ íŠ¸ë„ ê·¸ê±¸ ê·¸ëŒ€ë¡œ ë°˜ì˜í•˜ëŠ” êµ¬ì¡°ë¡œ ë°”ê¿”ë‹¬ë¼ëŠ” ìš”ì²­ì…ë‹ˆë‹¤.