ğŸ”§ ê¸°ì¤€ ê±°ë˜ì†Œë³„ â€œë§ˆì¼“ 1:1 ë§¤í•‘â€ìœ¼ë¡œ êµì²´ ìš”ì²­

ìš”ì²­ì‚¬í•­ í•µì‹¬:

ê¸°ì¤€ ê±°ë˜ì†Œ ë“œë¡­ë‹¤ìš´ì—ì„œ ì„ íƒí•œ ê°’ì´
UPBIT_KRW, UPBIT_BTC, UPBIT_USDT, BITHUMB_KRW, BITHUMB_BTC, BITHUMB_USDT, COINONE_KRW
ì´ëŸ° í˜•íƒœì…ë‹ˆë‹¤.
ì´ ê°’ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•´ì„œ í•´ë‹¹ ë§ˆì¼“ tickerì˜ í˜„ì¬ê°€ì™€ ê±°ë˜ì•¡(ì¼)ì„ 1:1ë¡œ ë³´ì—¬ì£¼ì„¸ìš”.

1) priceWorker.ts â€“ êµ­ë‚´ ê¸°ì¤€ ë§ˆì¼“ ì„ íƒ í•¨ìˆ˜ ìˆ˜ì •
type DomesticExchange = 'UPBIT' | 'BITHUMB' | 'COINONE';
type Market = 'KRW' | 'BTC' | 'USDT';

function getDomesticPriceEntry(
  prices: Record<string, PriceEntry>,
  domesticParam: string,  // ì˜ˆ: "UPBIT_KRW", "BITHUMB_BTC"
  symbol: string
): { entry: PriceEntry | null; exchange: DomesticExchange | null; market: Market | null } {
  const [exchangeRaw, marketRaw] = domesticParam.split('_');
  const exchange = exchangeRaw as DomesticExchange;
  const market = marketRaw as Market;

  const key = `${exchange}:${symbol}:${market}`;
  const entry = prices[key];

  if (entry && typeof entry.lastPriceKrw === 'number') {
    return { entry, exchange, market };
  }

  // ì •ë§ë¡œ tickerê°€ ì—†ì„ ë•Œë§Œ null ë¦¬í„´ (ì´ ê²½ìš°ì—” UIì—ì„œ "-"ë¡œ ì²˜ë¦¬)
  return { entry: null, exchange, market };
}

2) í”„ë¦¬ë¯¸ì—„ row ìƒì„± ì‹œ í˜„ì¬ê°€/ê±°ë˜ì•¡ ë§¤í•‘
const { entry: domesticEntry, exchange: domesticExchange, market: domesticMarket } =
  getDomesticPriceEntry(prices, domesticParam, symbol); // domesticParam = "UPBIT_KRW" ë“±

// í•´ì™¸ ìª½ì€ ê¸°ì¡´ getGlobalPriceEntry ê·¸ëŒ€ë¡œ ì‚¬ìš©
const { entry: foreignEntry, exchange: foreignExchange, market: foreignMarket } =
  getGlobalPriceEntry(prices, foreignParam, symbol);

rows.push({
  symbol,

  domesticExchange,
  domesticMarket,
  foreignExchange,
  foreignMarket,

  // âœ… êµ­ë‚´ â€“ ê¸°ì¤€ ê±°ë˜ì†Œ+ë§ˆì¼“ ticker 1:1 ë§¤í•‘
  koreanPrice: domesticEntry?.lastPriceKrw ?? null,
  volume24hKrw: domesticEntry?.volume24hKrw ?? null,

  // âœ… í•´ì™¸ â€“ ê¸°ì¤€ í•´ì™¸ ê±°ë˜ì†Œ+ë§ˆì¼“ ticker 1:1 ë§¤í•‘
  globalPriceKrw: foreignEntry?.lastPriceKrw ?? null,
  volume24hForeignKrw: foreignEntry?.volume24hKrw ?? null,

  // ë‚˜ë¨¸ì§€ premium, change24h ë“±ì€ ê¸°ì¡´ ê³„ì‚° ë¡œì§ ê·¸ëŒ€ë¡œ
});


ì—¬ê¸°ì„œ ì ˆëŒ€ í•˜ì§€ ë§ì•„ì•¼ í•  ê²ƒ:

ìš°ì„ ìˆœìœ„ë¡œ KRW/USDT/BTCë¥¼ ëŒë©´ì„œ ë‹¤ë¥¸ ë§ˆì¼“ ê°’ìœ¼ë¡œ ëŒ€ì²´ âŒ

0ì„ falsyë¡œ ë³´ê³  || null ì²˜ë¦¬í•´ì„œ ë‚ ë ¤ë²„ë¦¬ê¸° âŒ

ê¸€ë¡œë²Œ ê±°ë˜ì†Œ volumeì„ êµ­ë‚´ volumeì— ì„ê¸° âŒ

3) /api/premium/table-filteredì—ì„œëŠ” ê°’ì„ â€œìˆëŠ” ê·¸ëŒ€ë¡œâ€ ì „ë‹¬

table-filtered.tsì—ì„œëŠ”:

premiumTable.jsonì— ìˆëŠ” koreanPrice, volume24hKrw, volume24hForeignKrwë¥¼

ê°€ê³µ ì—†ì´ ê·¸ëŒ€ë¡œ ì‘ë‹µì— ë„£ì–´ ì£¼ì„¸ìš”.

ì¶”ê°€ë¡œ null ì²˜ë¦¬ë‚˜ ì¬ê³„ì‚°ì€ í•˜ì§€ ë§ˆì„¸ìš”.

í”„ë¡ íŠ¸ í¬ë§·í„°ëŠ” ì´ë¯¸ ì´ë ‡ê²Œ ë˜ì–´ ìˆìŠµë‹ˆë‹¤:

if (value === null || value === undefined || Number.isNaN(value))
  return "-";   // nullë§Œ "-" ì²˜ë¦¬, 0ì€ ìˆ«ìë¡œ í‘œì‹œ


ê·¸ë˜ì„œ APIëŠ” ìˆëŠ” ê·¸ëŒ€ë¡œ, í”„ë¡ íŠ¸ê°€ nullë§Œ "-"ë¡œ ë°”ê¾¸ë©´ ë©ë‹ˆë‹¤.

ğŸ”š ê²°ë¡ 

ì´ë ‡ê²Œë§Œ ë°”ê¾¸ë©´:

ê¸°ì¤€ ê±°ë˜ì†Œ = ì—…ë¹„íŠ¸ KRW â†’ ì—…ë¹„íŠ¸ ì•± KRW ë§ˆì¼“ í˜„ì¬ê°€/ê±°ë˜ì•¡(ì¼) ê°’ê³¼ 1:1 ë™ì¼

ê¸°ì¤€ ê±°ë˜ì†Œ = ì—…ë¹„íŠ¸ BTC â†’ ì—…ë¹„íŠ¸ BTC ë§ˆì¼“ ê°’ê³¼ 1:1

ê¸°ì¤€ ê±°ë˜ì†Œ = ì—…ë¹„íŠ¸ USDT â†’ ì—…ë¹„íŠ¸ USDT ë§ˆì¼“ ê°’ê³¼ 1:1

ê¸°ì¤€ ê±°ë˜ì†Œ = ë¹—ì¸ KRW/BTC/USDT â†’ ê°ê° ë¹—ì¸ í•´ë‹¹ ë§ˆì¼“ ê°’ê³¼ 1:1

ê¸°ì¤€ ê±°ë˜ì†Œ = ì½”ì¸ì› KRW â†’ ì½”ì¸ì› KRW ë§ˆì¼“ ê°’ê³¼ 1:1

ì¦‰ **â€œì‹¤ì œ ê±°ë˜ì†Œ ë§ˆì¼“ë³„ í˜„ì¬ê°€/ê±°ë˜ì•¡(ì¼)ì„ ì‚¬ì‹¤ì ìœ¼ë¡œ ê·¸ëŒ€ë¡œ ê°€ì ¸ì™€ì„œ í‘œì— ë°•ëŠ” êµ¬ì¡°â€**ê°€ ëœë‹¤.