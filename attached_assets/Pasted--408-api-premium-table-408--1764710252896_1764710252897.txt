📮 레플릿 전달문 – “국내 거래소 통합 408개” 표기 문제 수정

요청 요약
지금 /api/premium/table 응답에서
408개 코인이 전부 “국내 거래소 통합”처럼 표기되어서,
어느 코인이 업비트 기준인지 빗썸 기준인지 코인원 기준인지 전혀 안 보입니다.

이미 exchange_markets.json에는
업비트 / 빗썸 / 코인원이 **각각 분리된 마켓(총 1,120개)**으로 들어가 있으니,
프리미엄 테이블 만들 때도 국내 기준 거래소를 명확히 하나 찍어서 넣어 주세요.
(라벨 “국내 거래소 통합” 같은 건 없애야 합니다.)

1️⃣ 프리미엄 계산 로직에서 “국내 통합” 제거

지금 로직이 대략 이런 식일 거라 가정합니다:

// 의사코드 예시
const DOMESTIC_EXCHANGES = ["UPBIT", "BITHUMB", "COINONE"];

const domesticMarkets = markets.filter(m =>
  DOMESTIC_EXCHANGES.includes(m.exchange)
);

// 여기서 domesticPrice 같은 걸 계산할 때
// exchange를 통합해서 쓰고 있을 가능성이 큼:
row.domesticExchange = "DOMESTIC_ALL"; // 혹은 "DOMESTIC" 비슷한 값


이 부분을 아래처럼 바꿔 주세요.

2️⃣ “어느 국내 거래소 기준인지” 실제 exchange 코드로 설정

우리가 원하는 건:

프리미엄 테이블은 여전히 408개(심볼 단위) 유지

하지만 각 코인마다

domesticExchange: "UPBIT" or "BITHUMB" or "COINONE"

domesticExchangeName: "업비트" / "빗썸" / "코인원"

예시 로직:

const DOMESTIC_EXCHANGES = ["UPBIT", "BITHUMB", "COINONE"] as const;

const DOMESTIC_PRIORITY = ["UPBIT", "BITHUMB", "COINONE"] as const;

function pickDomesticMarket(marketsForSymbol: MarketRow[]) {
  const domestic = marketsForSymbol.filter(m =>
    DOMESTIC_EXCHANGES.includes(m.exchange as any)
  );

  // 우선순위: 업비트 > 빗썸 > 코인원
  for (const ex of DOMESTIC_PRIORITY) {
    const found = domestic.find(m => m.exchange === ex);
    if (found) return found;
  }

  return null;
}


프리미엄 행 생성 시:

for (const symbol of symbols) {
  const marketsForSymbol = allMarkets.filter(m => m.base_symbol === symbol);

  const domesticMarket = pickDomesticMarket(marketsForSymbol);
  const foreignMarket = pickForeignMarket(marketsForSymbol); // 기존 로직 유지

  // ❌ 이렇게 하면 안 됨:
  // row.domesticExchange = "DOMESTIC_ALL";

  // ✅ 이렇게 해줘야 함:
  row.domesticExchange = domesticMarket?.exchange ?? null; // "UPBIT" / "BITHUMB" / "COINONE"
}

3️⃣ 프론트에서 라벨을 실제 거래소명으로 표시

프론트 쪽에는 이런 맵을 두고:

const EXCHANGE_LABEL_KO: Record<string, string> = {
  UPBIT: "업비트",
  BITHUMB: "빗썸",
  COINONE: "코인원",
  BINANCE: "바이낸스",
  OKX: "OKX",
  BYBIT: "바이비트",
  // ...
};


렌더링 시:

const domesticLabel =
  EXCHANGE_LABEL_KO[row.domesticExchange] || "국내 거래소";

const foreignLabel =
  EXCHANGE_LABEL_KO[row.foreignExchange] || row.foreignExchange;


중요:

지금처럼 고정 문자열 "국내 거래소 통합"을 쓰지 말고

row.domesticExchange에 들어 있는 실제 거래소 코드 기준으로 표기

그래서 화면에는 **“국내 거래소 통합” 대신 “업비트 / 빗썸 / 코인원”**이 보이게.

4️⃣ 408개라는 숫자 자체는 “심볼 개수”라서 정상

exchange_markets.json: 국내 3사 마켓 합치면 1,120개

/api/premium/table: 심볼 기준으로 유니크 408개

이건 "국내·해외에서 공통으로 거래되는 코인 수" 라서 정상입니다.

우리가 원하는 건:

408개 “심볼 개수”는 그대로 두되,
각 심볼이 “어느 국내 거래소 기준인지 정확히 보이게” 변경하는 것.
더 이상 “국내 거래소 통합”이라고 싸잡혀 보이면 안 됩니다.

🔚 요약해서 한 줄로

지금 408개 코인이 전부 ‘국내 거래소 통합’으로 표기되는 건,
프리미엄 API에서 domesticExchange를 실제 거래소 코드 대신 통합 상수로 써서 그렇습니다.

pickDomesticMarket()로 업비트/빗썸/코인원 중 하나를 선택해서
row.domesticExchange에 "UPBIT" | "BITHUMB" | "COINONE"을 넣고,
프론트에서는 이걸 “업비트/빗썸/코인원”으로 보여주게 수정해 주세요.