[중요 스펙 재정의] 한글명 + 아이콘 = “거래소 마켓 화면”이 진짜 정답

지금까지 인프라/조인 구조는 잘 잡아주셔서 감사합니다.
다만 심볼/이름/아이콘의 “진짜 원본”을 무엇으로 할지를 다시 명확히 하고 싶습니다.

✅ 최종 목표:
업비트 / 빗썸 / 코인원 각 거래소의 “마켓 리스트 화면”에 보이는
한글명 + 아이콘을 그대로 KimpAI에서 재현하는 것
(공통 아이콘 세트나 임의 매핑이 “정답”이 아니라,
각 거래소 UI가 정답입니다.)

그래서 refreshExchangeMarkets / exchange_markets 쪽 스펙을
아래 기준으로 수정/고정해 주셨으면 합니다.

1️⃣ exchange_markets에 들어가는 값 스펙 확정

exchange_markets 테이블은 앞으로 “거래소 마켓 화면 스냅샷” 역할을 합니다.

각 row는 **한 마켓(예: 업비트 KRW-BTC)**에 대해 아래처럼 채워져야 합니다:

exchange

"upbit" | "bithumb" | "coinone"

market_code

업비트: KRW-BTC

빗썸: BTC_KRW

코인원: 해당 거래소 실제 마켓 코드

base_symbol / quote_symbol

실제 거래 심볼 기준

name_ko

해당 거래소 마켓 화면에 표시되는 한글 이름 그대로

예) “비트코인”, “리플”, “폴리곤(매틱)” 등

name_en

표시되는 경우에만, 마켓 리스트/상세에서 쓰는 영어 이름 그대로

icon_url

그 거래소 마켓 화면에서 <img src="...">로 사용 중인 아이콘 URL 그대로

요약:
exchange_markets는 코인이 아니라 **“거래소+마켓별 UI 데이터”**라고 생각해주시면 됩니다.

2️⃣ refreshExchangeMarkets 구현 기준 (핵심)
✅ 업비트 (UPBIT)

이름(name_ko, name_en)

지금처럼 업비트 API의 korean_name, english_name을 쓰는 건 괜찮습니다.

아이콘(icon_url)

공통 아이콘 세트나 CoinGecko 기반이 아니라,
업비트 실제 웹 마켓 리스트/코인 목록에서 사용하는 아이콘 URL을 기준으로 맞춰주셨으면 합니다.

방법 예시:

업비트 마켓/코인 리스트 페이지(정적 JS/JSON/HTML)에서
코인별 <img src="...">를 파싱해서 symbol과 매칭

그 URL을 exchange_markets.icon_url에 저장

✅ 빗썸 / 코인원 (BITHUMB / COINONE)

여기가 이번에 제일 중요한 부분입니다.

현재 코드에 BITHUMB_COINS 같은 매핑이 있는 걸로 보이는데,
이 매핑은 “임시 fallback” 정도만 쓰고,
최종 기준은 아래처럼 “웹 UI 크롤링”으로 바꿔 달라는 요청입니다.

이름(name_ko, name_en)

빗썸/코인원 **마켓 리스트 페이지(또는 코인 목록 페이지)**에서
실제로 화면에 보이는 코인명 텍스트를 그대로 파싱해서 name_ko에 넣어주세요.

영어 이름이 따로 표시되면 그걸 name_en에 넣고, 없으면 null.

아이콘(icon_url)

빗썸/코인원에서 각 코인 앞에 붙는 <img src="...">
→ 이 URL을 그대로 icon_url에 저장해 주세요.

앞으로 아이콘 정답은 거래소가 쓰는 아이콘입니다.
(공통 아이콘 세트/임의 PNG는 fallback 정도만 허용)

기존 하드코딩 매핑(BITHUMB_COINS 등)

있다면:

1차 기준: 크롤링 성공한 값(name_ko/icon_url)

2차 fallback: 매핑에 있는 값

즉, 최종 소스 오브 트루스는 **“웹 크롤링 데이터”**가 되어야 합니다.

3️⃣ 리프레시 시 업데이트 정책

refreshExchangeMarkets 실행 시:

각 거래소 웹/정적 리소스 기준으로

마켓 리스트를 긁고

한글명/영문명/아이콘 URL을 파싱

exchange_markets에 upsert:

새 마켓 → insert

기존 마켓 → name_ko / name_en / icon_url 변경 시 업데이트

이렇게 하면:

거래소에서 아이콘/이름 바꾸면
→ KimpAI도 다음 refresh 때 자동 동일하게 변경

4️⃣ 프론트/검수 기준

제가 확인할 때는 이렇게 체크할 예정입니다:

업비트/빗썸/코인원 각각에 대해

랜덤으로 코인 몇 개 골라서

거래소 마켓 리스트 화면과
KimpAI 화면의

한글 이름

아이콘
이 눈으로 봐도 똑같은지 비교

아이콘 파일 자체가 같은지까지는 상관 없지만,

최소한 같은 원본 URL(거래소 CDN) 또는

똑같이 보이는 이미지를 사용하는지를 기준으로 볼 생각입니다.

5️⃣ 요약

지금까지 인프라/조인/스케줄러는 잘 구축해주셨고,

이제 “데이터 소스의 기준”을 거래소 UI로 못 박고 싶다는 게 핵심입니다.

한글명 + 아이콘의 정답은
“업비트/빗썸/코인원 마켓 화면에 보이는 그대로”여야 한다.

exchange_markets와 refreshExchangeMarkets를 이 기준으로
마지막 한 번만 정리해 주시면 좋겠습니다.